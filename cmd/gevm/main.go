package main

import (
	"github.com/Jesserc/gevm/gevm"
	"github.com/ethereum/go-ethereum/common"
)

func main() {
	evm := gevm.New(common.HexToAddress("0x"), 10000000000, 2e5, 1, 8000000, []byte{}, []byte{})

	// evm.Stack.Push(uint256.NewInt(0).SetBytes(hexutil.MustDecode("0x00000000000000000000000000000000000000000000000000000000FFFFFFFF")))
	// evm.Stack.Push(uint256.NewInt(0).SetBytes(hexutil.MustDecode("0xFFFFFFFF00000000000000000000000000000000000000000000000000000000")))
	// evm.Stack.Push(uint256.NewInt(32))

	SIMPLE_ADD := []byte{0x60, 0x42, 0x60, 0xFF, 0x01}
	SIMPLE_PUSH := []byte{0x60, 0x42}
	evm.Code = SIMPLE_PUSH
	evm.Code = SIMPLE_ADD

	SIMPLE_REVERT := []byte{0x60, 0x1f, 0x60, 0x01, 0x01, 0x60, 0x00, 0x60, 0x00, 0xFD, 0x60, 0x20}
	evm.Code = SIMPLE_REVERT

	SIMPLE_MUL := []byte{0x60, 0x02, 0x60, 0x02, 0x02, 0x00}
	evm.Code = SIMPLE_MUL

	SIMPLE_STORE := []byte{0x60, 0x20, 0x5f, 0x55}
	SIMPLE_STORE2 := []byte{0x60, 0x20, 0x5f, 0x55, 0x60, 0xa, 0x5f, 0x55}
	SIMPLE_STORE3 := []byte{0x60, 0x20, 0x5f, 0x55, 0x60, 0xa, 0x60, 0x1f, 0x55, 0x60, 0xa, 0x60, 0x2f, 0x55}
	evm.Code = SIMPLE_STORE
	evm.Code = SIMPLE_STORE2
	evm.Code = SIMPLE_STORE3

	// real bytcode from a contract
	evm.Code = common.Hex2Bytes("608060405234801561000f575f80fd5b5060043610610034575f3560e01c8063ef88a09214610038578063fd08921b14610054575b5f80fd5b610052600480360381019061004d91906100ba565b610072565b005b61005c61007b565b60405161006991906100f4565b60405180910390f35b805f8190555050565b5f8054905090565b5f80fd5b5f819050919050565b61009981610087565b81146100a3575f80fd5b50565b5f813590506100b481610090565b92915050565b5f602082840312156100cf576100ce610083565b5b5f6100dc848285016100a6565b91505092915050565b6100ee81610087565b82525050565b5f6020820190506101075f8301846100e5565b9291505056fea2646970667358fe12206e2fa38c90ceec2dd7d9ed77cc97192ffe630697b4af456c9dac68d72459b2b164736f6c63430008190033")
	evm.Calldata = common.Hex2Bytes("fd08921b")
	// evm.Calldata = common.Hex2Bytes("ef88a092")``
	// fmt.Println(evm.Calldata)
	evm.Run()
}
